"use strict";const elementForm=document.querySelector("#form"),searchInput=document.querySelector("#input-search"),searchButton=document.querySelector("#btn-search"),elementList=document.querySelector("#list"),urlBase="http://api.tvmaze.com/search/shows?q=",inputValue=searchInput.value.toLowerCase(),favList=document.querySelector("#fav-list"),resetButton=document.querySelector("#btn-reset");let favShows=[];function conectApi(){const e=searchInput.value.toLowerCase();fetch(urlBase+e).then(e=>e.json()).then(e=>{paintResults(e)})}function paintResults(e){elementList.innerHTML="";for(const t of e)if(-1!==t.show.name.toLowerCase().indexOf(inputValue)){const e=document.createElement("li"),n=document.createElement("img"),a=document.createElement("span"),o=document.createTextNode(t.show.name);elementList.appendChild(e),e.appendChild(n),e.appendChild(a),a.appendChild(o),e.classList.add("list"),null!==t.show.image.medium?n.src=t.show.image.medium:n.src="https://via.placeholder.com/210x295/ffffff/666666/?\n    text=TV",e.addEventListener("click",favShowToggle),e.addEventListener("click",chooseFavouritesShows)}}function favShowToggle(e){e.currentTarget.classList.toggle("favourites")}function chooseFavouritesShows(e){const t=e.currentTarget.querySelector("span"),n=e.currentTarget.querySelector("img"),a={name:t.innerHTML,img:n.src};favShows.push(a),localStorage.setItem("favourites",JSON.stringify(favShows)),paintFavShows(a)}function init(){const e=localStorage.getItem("favourites");null!==e&&(favShows=JSON.parse(e)),paintInitialFavList(favShows)}function paintInitialFavList(e){for(const t of e)paintFavShows(t)}function paintFavShows(e){const t=document.createElement("li"),n=document.createElement("img"),a=document.createElement("span"),o=document.createTextNode(e.name),s=document.createElement("button"),i=document.createTextNode("X");n.src=e.img,favList.appendChild(t),t.appendChild(n),t.appendChild(a),t.appendChild(s),a.appendChild(o),s.appendChild(i),s.addEventListener("click",deleteFavShows)}function submitHandler(e){e.preventDefault(),conectApi()}function resetFavList(){localStorage.clear("favourites"),favList.innerHTML=""}function deleteFavShows(e){e.currentTarget.closest("li").classList.add("hidden")}window.addEventListener("load",init),searchButton.addEventListener("click",conectApi),elementForm.addEventListener("submit",submitHandler),resetButton.addEventListener("click",resetFavList);